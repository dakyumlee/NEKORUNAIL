<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>갤러리 - NEKORUNAIL</title>
  <link rel="stylesheet" href="style.css">
  <script>
    // 갤러리 데이터 가지오기
    function getLocalGallery() {
      const stored = localStorage.getItem('nekorunail_gallery');
      return stored ? JSON.parse(stored) : [];
    }

    function loadGallery() {
      try {
        const gallery = document.getElementById("gallery-show");
        const galleryData = getLocalGallery();
        
        console.log('갤러리 데이터 로드:', galleryData.length, '개');
        
        gallery.innerHTML = '';
        
        if (galleryData.length === 0) {
          gallery.innerHTML = `
            <div style="
              text-align: center; 
              padding: 4rem 2rem; 
              color: #718096;
              background: white;
              border-radius: 18px;
              box-shadow: 0 8px 20px rgba(0,0,0,0.1);
              margin: 2rem auto;
              max-width: 600px;
            ">
              <div style="font-size: 3rem; margin-bottom: 1rem;">🖼️</div>
              <h3 style="color: #4a5568; margin-bottom: 1rem;">갤러리가 비어있습니다</h3>
              <p>관리자가 업로드한 네일 디자인이 여기에 표시됩니다.</p>
            </div>
          `;
          return;
        }
        
        galleryData.forEach(data => {
          const card = document.createElement("div");
          card.className = "gallery-card";
          card.style.cssText = `
            min-width: 280px;
            background: white;
            border-radius: 18px;
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            cursor: pointer;
            margin-bottom: 2rem;
          `;
          
          card.addEventListener('mouseenter', function() {
            this.style.transform = 'translateY(-5px) scale(1.02)';
            this.style.boxShadow = '0 15px 35px rgba(0,0,0,0.15)';
          });
          
          card.addEventListener('mouseleave', function() {
            this.style.transform = 'translateY(0) scale(1)';
            this.style.boxShadow = '0 8px 20px rgba(0,0,0,0.1)';
          });
          
          const createdAt = new Date(data.createdAt);
          const dateString = createdAt.toLocaleDateString('ko-KR');
          
          card.innerHTML = `
            <img src="${data.imageUrl}" alt="nail design" style="
              width: 100%;
              height: 240px;
              object-fit: cover;
              display: block;
            " />
            <div class="info" style="
              padding: 1.5rem;
              text-align: center;
            ">
              <h4 style="
                margin: 0 0 0.5rem;
                font-weight: 600;
                font-size: 1.1rem;
                color: #333;
              ">${data.caption || "네일 디자인"}</h4>
              <p style="
                margin: 0;
                color: #666;
                font-size: 0.9rem;
              ">업로드: ${dateString}</p>
            </div>
          `;
          
          card.addEventListener('click', function() {
            openImageModal(data.imageUrl, data.caption || "네일 디자인");
          });
          
          gallery.appendChild(card);
        });
        
        console.log('갤러리 로드 완료!');
        
      } catch (error) {
        console.error("갤러리 로드 실패:", error);
        const gallery = document.getElementById("gallery-show");
        if (gallery) {
          gallery.innerHTML = `
            <div style="text-align: center; padding: 2rem; color: #ef4444;">
              <h3>갤러리 로드 실패</h3>
              <p>오류: ${error.message}</p>
            </div>
          `;
        }
      }
    }

    function openImageModal(imageUrl, caption) {
      const modal = document.createElement('div');
      modal.style.cssText = `
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 10000;
        cursor: pointer;
      `;
      
      modal.innerHTML = `
        <div style="
          position: relative;
          max-width: 90vw;
          max-height: 90vh;
          background: white;
          border-radius: 10px;
          overflow: hidden;
          box-shadow: 0 20px 40px rgba(0,0,0,0.3);
        ">
          <span style="
            position: absolute;
            top: 10px;
            right: 15px;
            font-size: 2rem;
            color: white;
            cursor: pointer;
            z-index: 10001;
            background: rgba(0,0,0,0.5);
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
          ">&times;</span>
          <img src="${imageUrl}" alt="${caption}" style="
            max-width: 100%;
            max-height: 80vh;
            display: block;
          " />
          <div style="
            padding: 1rem;
            text-align: center;
            background: white;
          ">
            <h3 style="margin: 0; color: #333;">${caption}</h3>
          </div>
        </div>
      `;
      
      document.body.appendChild(modal);
      
      const closeModal = function() {
        document.body.removeChild(modal);
      };
      
      modal.querySelector('span').onclick = closeModal;
      modal.onclick = function(e) {
        if (e.target === modal) closeModal();
      };
      
      document.addEventListener('keydown', function escHandler(e) {
        if (e.key === 'Escape') {
          closeModal();
          document.removeEventListener('keydown', escHandler);
        }
      });
    }

    document.addEventListener('DOMContentLoaded', function() {
      console.log('갤러리 페이지 로드 완료');
      loadGallery();
    });
  </script>
</head>
<body>
  <header class="hero">
    <nav>
      <ul>
        <li><a href="index.html">홈</a></li>
        <li><a href="gallery.html">갤러리</a></li>
        <li><a href="booking.html">예약</a></li>
        <li><a href="review.html">리뷰 남기기</a></li>
        <li><a href="come.html">찾아오시는 길</a></li>
      </ul>
    </nav>
    <br><br>
    <h1>네일 디자인 쇼케이스</h1>
    <p>관리자가 업로드한 아름다운 네일 디자인들을 감상해보세요</p>
  </header>

  <section id="gallery" style="padding: 3rem 1.5rem; max-width: 1200px; margin: auto;">
    <div id="gallery-show" class="gallery-slider" style="
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
      gap: 2rem;
      margin-top: 2rem;
    ">
      <div style="text-align: center; padding: 2rem; color: #718096;">
        <p>갤러리를 불러오는 중...</p>
      </div>
    </div>
  </section>

  <footer>
    <p>NEKORUNAIL ⎜ Instagram @NEKORUnail ⎜ 2025</p>
  </footer>
</body>
</html>